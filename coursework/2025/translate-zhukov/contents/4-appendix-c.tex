\appendixsection{Сублинейная схема о размерности решетки}

\subsection*{Исторические результаты}

В этом разделе мы обсуждаем выбор размерности решётки $n$ в алгоритме Шнорра.
Размерность определяется мощностью простого базиса и существенно влияет на
эффективность алгоритма. С одной стороны, при большом $n$ число гладких пар на
простом базисе резко возрастает, упрощая их поиск. С другой — время работы
редукции базиса и решения систем линейных уравнений растёт вместе с $n$.
Следовательно, необходимо сбалансировать оба фактора. В оригинальных работах
Шнорра \cite{cite_29,cite_30,cite_41} вопрос выбора $n$ раскрыт не полностью,
поэтому в разных публикациях встречаются разные подходы. В обновлённой версии
Шнорра 2021 г.\,\cite{cite_30} для конкретных примеров используется сублинейная
размерность, но без объяснений. Например, при факторизации 400‑битного числа
размерность решетки составляет $48$, что близко к схеме $400/\log_{2}400
\approx 46$. Во многих других работах размерность решётки $n$ обычно
предполагают полиномиальной от длины $m$ большого целого числа $N$. Объяснение
дано из ограничения на предел гладкости $p_{n}$. В решете Шнорра предел
гладкости обычно принимают удовлетворяющим условию:

\begin{equation}
    p_{n} \;\approx\; (\log N)^{\alpha} \;=\; m^{\alpha},
    \qquad \alpha>0 .
\end{equation}

\noindent Согласно теореме о простых числах получаем

\begin{equation}
    n \;\approx\; \frac{(\log N)^{\alpha}}{\alpha\log\log N}
    \;=\; \frac{m^{\alpha}}{\alpha\log m}.
\end{equation}

\noindent При $\alpha = 1$ имеем

\begin{equation}
    n \;=\; \frac{m}{\log m},
\end{equation}

\noindent что даёт сублинейную размерность по длине числа $N$. При $\alpha>1$
$n$ становится полиномиальным по $m$. Таким образом, именно выбор $\alpha$
определяет размерность решётки.

Параметр $\alpha$ связан с математической зависимостью между коротким вектором
и гладкой парой. Условие, при котором короткие векторы дают гладкие пары,
сформулировано Шнорром в следующей лемме.

\textbf{Лемма 1.} Если $\lVert b - t\rVert^{2} = O(\log N) \quad\text{и}\quad
v \le N^{\,c-1}p_{n}\bigl(n/\log N\bigr)^{1/2}$,
то, с высокой вероятностью, $|u-vN| = O(p_{n})$.

Здесь $c$ — параметр точности. Лемма утверждает, что когда квадрат нормы
короткого вектора равен $O(\log N)$, то скорее ввсего sr‑пары могут быть
получены. Мы принимаем $O(\log N)$ как теоретическую границу длины короткого
вектора.

Возникает следующий важный вопрос: существуют ли короткие векторы,
удовлетворяющие этому условию, и достаточно ли их. Шнорр показал, что их много
при $\alpha>2$. Величина $\alpha$ пропорциональна пределу гладкости по формуле
В.11. В методе решета чем больше гладкая граница $p_{n}$, тем легче найти
гладкие пары, но тем больше их требуется всего. Шнорр доказал, что при
$\alpha>(2c-1)/(c-1)>2$ существует большое количество коротких векторов,
формирующих гладкие пары, что ведёт к полиномиальной размерности схемы.

Ниже мы рассматриваем связь между коротким вектором и гладкой парой с точки
зрения существования короткого вектора. Сначала приведена линейная схема
размерности $n$, основанная на первой теореме Минковского \cite{cite_42}.
Затем, опираясь на предположение о плотности в алгоритме Шнорра \cite{cite_30},
выводится сублинейная схема размерности решётки.

\subsection*{Линейная схема}

Проблема существования заключается в том, существует ли вектор
$b\in\Lambda(B_{n,c})$ такой, что выполняется условие $\lVert
b-t\rVert^{2}=O(\log N)$. Мы оцениваем расстояние от целевого вектора $t$ до
решётки $\Lambda$ через длину $\lambda_{1}$ кратчайшего вектора в расширенной
решётке $\bar B_{n,c}=[B_{n,c},\,t]$. Поскольку детерминант $\bar B_{n,c}$
известен, верхнюю границу для $\lambda_{1}$ можно получить по первой теореме
Минковского, формулируемой так.

\textbf{Лемма 2 (первая теорема Минковского).} Для любой полной решётки
$\Lambda$ размерности $n$
\begin{equation}
\lambda_{1}(\Lambda)^{2} \;\le\; n\,(\det\Lambda)^{2/n}.
\end{equation}

Первая теорема Минковского даёт верхнюю границу для кратчайшего ненулевого
вектора, то есть первой последовательной минимальной $\lambda_{1}$. На основе
этой оценки получаем следующий результат.

\textbf{Утверждение 1.} Если размерность решётки $B_{n,c}$ равна
$n = \log N$, то существует вектор $b\in\Lambda(\bar B_{n,c})$, для которого
\begin{equation}
\lVert b - t\rVert^{2} = O(\log N).
\end{equation}

\textit{Доказательство.}
Обозначим длину кратчайшего вектора расширенной решётки $\bar B_{n,c}$ через
$\lambda_{1}$. Здесь мы используем порядок $\lambda_{1}$ чтобы оценить
$\operatorname{dist}(B_{n,c},t)$ между решеткой и целевым вектором, полагая что
$\operatorname{dist}(B_{n,c},t)=O(\lambda_{1})$. По первой теореме Минковского
имеем:
\begin{equation}
\lambda_{1}^{2}
\;\le\;
(n+1)\,\bigl(\det\bar B_{n,c}\bigr)^{2/(n+1)}.
\end{equation}

\noindent С учётом конструкции решётки получаем
\begin{equation}
\bigl(\det\bar B_{n,c}\bigr)^{2/(n+1)}
\;=\;
\Bigl(\,\prod_{i=1}^{n} f(i)\Bigr)^{2/(n+1)}
\bigl(N^{c}\log N\bigr)^{2/(n+1)} .
\end{equation}

\noindent Предположим, что диагональные элементы выбираются из множества $\{1,2\}$,
причём двойки занимают долю $(n+1)/(3n)$, — это обеспечивает достаточное
количество различных перестановок для случайных решёток. Тогда
\begin{equation}
\Bigl(\,\prod_{i=1}^{n} f(i)\Bigr)^{2/(n+1)}
  = \bigl(2^{(n+1)/3}\bigr)^{2/(n+1)}
  = 2^{2/3}
  = O(1).
\end{equation}

\noindent Подставляя в уравнение В.18 и $n=\log N$ в В.17, получаем
\begin{equation}
\bigl(\det\bar B_{n,c}\bigr)^{2/(n+1)}
  = O\!\bigl(N^{\,2c/(n+1)}\bigr)
  = O\!\bigl(2^{\,2cn/(n+1)}\bigr)
  = O(1).
\end{equation}

\noindent Отсюда следует
\begin{equation}
\lambda_{1}^{2} \;\le\; n\,O(1) \;=\; O(\log N),
\end{equation}

\noindent что и завершает доказательство.

Отметим, что в построении решётки диагональные элементы берутся из $\{1,2\}$, а
число двоек приблизительно равно $(n+1)/(3n)$. Это условие можно обобщить до
\begin{equation}
\prod_{i=1}^{n} f(i)^{2/(n+1)} \;\sim\; O(1).
\end{equation}

В первой теореме Минковского верхнюю границу можно уточнить, используя
постоянные Эрмита. Рассмотрим соотношение:
\begin{equation}
\gamma \;=\;
\frac{\lambda_{1}^{2}(\Lambda)}{(\det\Lambda)^{2/n}}.
\end{equation}

\textbf{Определение 1.} Обозначим через $\gamma_{n}$ наибольшее значение,
удовлетворяющее В.22 для всех $n$‑мерных решёток. Тогда $\gamma_{n}$ называют
\textit{постоянной Эрмита} размерности $n$.

На самом деле $\gamma_{n}$ является точной верхней границей: для каждого $n>1$
существует решётка, в которой достигается равенство
$\gamma_{n}=\lambda_{1}^{2}(\Lambda)/(\det\Lambda)^{2/n}$. Такие решётки
называют критическими. Но вычисление точного значения $\gamma_{n}$ обычно
сложно, что также является основной проблемой в изучении геометрических чисел
Минковского. Точные значения $\gamma_{n}$ известны лишь для $1\le n\le8$ и
$n=24$; асимптотически лучшая оценка \cite{cite_43}
\begin{equation}
\lambda_{1}^{2}
\;\le\;
\gamma_{n}\,(\det\Lambda)^{2/n}
\;\le\;
\frac{1.744\,n}{2e\pi}\,(\det\Lambda)^{2/n}.
\end{equation}

Используя В.23 для оценки $\lambda_{1}$, получаем тот же вывод, что и в
утверждение 1.

\subsection*{Сублинейная схема}

Поскольку первая теорема Минковского даёт лишь верхнюю границу для длины
кратчайшего вектора, у многих случайных решёток действительная длина этого
вектора значительно отличается от оценки. Этот разрыв удобно измерять
относительной плотностью решётки rd$(\Lambda)$. Относительная плотность
rd$(\Lambda)$ определяется как отношение действительной длины кратчайшего
вектора $\lambda_{1}$ к верхней границе, полученной через постоянную Эрмита. Из
уравнения В.23 следует, что $0<\text{rd}(\Lambda)\le1$. Точное определение:
\begin{equation}
\operatorname{rd}(\Lambda)
  = \frac{\lambda_{1}}{\sqrt{\gamma_{n}}\;(\det\Lambda)^{1/n}}.
\end{equation}

Когда относительная плотность близка к 1, это означает, что оптимальные векторы
базиса решётки имеют одинаковую длину, а точки решётки расположены плотно.

Шнорр сделал следующее допущение о относительной плотности решёток,
используемых для поиска гладких пар, анализируя эффективность алгоритма.

\textbf{Допущение 1.}
Случайная решётка $\Lambda$ с базисом
$B=[b_{1},\dots,b_{n}]$ имеет относительную плотность, удовлетворяющую
\begin{equation}
\operatorname{rd}(\Lambda)
\;\le\;
\Bigl(
  \sqrt{\frac{e\pi}{2n}}\,
  \frac{\lambda_{1}}{\lVert b_{1}\rVert}
\Bigr)^{1/2},
\end{equation}

\noindent то есть $b_{1}$ и $\operatorname{rd}(\Lambda)$ достаточно малы. Поскольку
$\lambda_{1}/\lVert b_{1}\rVert\le 1$, из этого допущения следует
\begin{equation}
\operatorname{rd}(\Lambda)
  = \frac{\lambda_{1}}
         {\sqrt{\gamma_{n}}\,
          (\det\Lambda)^{1/n}}
  \;\le\;
  \Bigl(\frac{e\pi}{2n}\Bigr)^{1/4}.
\end{equation}

\noindent Cледовательно, имеем следующие результаты.

\textbf{Утверждение 2.} Если размерность решётки $B_{n,c}$ удовлетворяет $n =
\frac{2c\,\log N}{\log\log N}$, а относительная плотность удовлетворяет
Допущению 1, то существует вектор $b\in\Lambda(B_{n,c})$, такой что
\begin{equation}
 \lVert b - t\rVert^{2} = O(\log N).
\end{equation}

\textit{Доказательство.}
Из равенства В.26 имеем
\begin{equation}
  \lambda_{1}^{2}
  \;\le\;
  \Bigl(\frac{e\pi}{2n}\Bigr)^{1/2}\,
  \gamma_{n}\,(\det\Lambda)^{2/n}.
\end{equation}

\noindent Подставляя В.17 и В.18 в уравнение выше получаем
\begin{equation}
  \lambda_{1}^{2}
  \;\le\;
  \Bigl(\frac{e\pi}{2n}\Bigr)^{1/2}\,
  \gamma_{n}\,N^{2c/n}.
\end{equation}

\noindent Если принять $n = 2c\log N/\log\log N$, то
\begin{equation}
  \lambda_{1}^{2}
  \;\le\;
  \Bigl(\frac{e\pi}{2n}\Bigr)^{1/2}
  \frac{1.744}{2e\pi}\,
  \sqrt{\frac{2c\log N}{\log\log N}}\,
  \log N = O(\log N).
\end{equation}

Здесь величина $\sqrt{2c\log N/\log\log N}$ — порядок меньший, чем $\log N$,
поэтому в итоговом выражении она опущена. Что и требовалось доказать.

Игнорирование указанной низшего порядка величины оправдано. При $c=1$ и
$N\approx 2^{1024}$ получаем
\begin{equation}
  \Bigl(\frac{e\pi}{2}\Bigr)^{1/2}
  \frac{1.744}{2e\pi}\,
  \sqrt{\frac{2\log N}{\log\log N}}
  \;\approx\; 3.0960 \sim O(1).
\end{equation}

\noindent А при $N\approx 2^{2048}$ имеем
\begin{equation}
  \Bigl(\frac{e\pi}{2}\Bigr)^{1/2}
  \frac{1.744}{2e\pi}\,
  \sqrt{\frac{2\log N}{\log\log N}}
  \;\approx\; 4.1641 \sim O(1).
\end{equation}

\noindent Следовательно, при выполнении Допущения 1 выбор размерности $n=2c\log
N/\log\log N$ рационален, и квадрат нормы кратчайшего вектора гарантированно
остаётся порядка $O(\log N)$. Это означает, что с высокой вероятностью гладкая
пара может быть получена из ближайшего вектора решётки, как утверждается
в Лемме 1.

